<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.62.2" />
    <meta name="description" content="neptec">
<meta name="author" content="Pratik">

    <link rel="icon" href="/images/favicon1.png" type="image/png">

    <title>Mail Cleaner :: Documentation</title>

    
    <link href="/css/nucleus.css?1584878192" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1584878192" rel="stylesheet">
    <link href="/css/hybrid.css?1584878192" rel="stylesheet">
    <link href="/css/featherlight.min.css?1584878192" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1584878192" rel="stylesheet">
    <link href="/css/auto-complete.css?1584878192" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1584878192" rel="stylesheet">
    <link href="/css/theme.css?1584878192" rel="stylesheet">
    <link href="/css/hugo-theme.css?1584878192" rel="stylesheet">
    
      <link href="/css/theme-mine.css?1584878192" rel="stylesheet">
    

    <script src="/js/jquery-3.3.1.min.js?1584878192"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    

  </head>
  <body class="" data-url="/mailcleaner/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a href="/">
<img src="/images/f1soft.png" alt="f1soft" style="width:80px;height:80px;">
</a>


    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1584878192"></script>
<script type="text/javascript" src="/js/auto-complete.js?1584878192"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/10.20.222.175\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1584878192"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/mailcleaner/" title="Mail Cleaner" class="dd-item 
        parent
        active
        
        ">
      <a href="/mailcleaner/">
          Mail Cleaner
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/hardening/" title="System Hardening" class="dd-item 
        
        
        
        ">
      <a href="/hardening/">
          System Hardening
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/glassfish/" title="Glassfish" class="dd-item 
        
        
        
        ">
      <a href="/glassfish/">
          Glassfish
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/glassfish/tunning/" title="Glassfish Tunning" class="dd-item ">
        <a href="/glassfish/tunning/">
        Glassfish Tunning
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/chrony/" title="Chrony" class="dd-item 
        
        
        
        ">
      <a href="/chrony/">
          Chrony
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/redis/" title="Redis" class="dd-item 
        
        
        
        ">
      <a href="/redis/">
          Redis
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/zimbra-tips-tricks/" title="Zimbra Tips &amp; Tricks" class="dd-item 
        
        
        
        ">
      <a href="/zimbra-tips-tricks/">
          Zimbra Tips &amp; Tricks
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/kaspersky/" title="Kaspersky" class="dd-item 
        
        
        
        ">
      <a href="/kaspersky/">
          Kaspersky
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/kaspersky/kaspersky_linux/" title="Kaspersky for linux" class="dd-item ">
        <a href="/kaspersky/kaspersky_linux/">
        Kaspersky for linux
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/snmp/" title="SNMP" class="dd-item 
        
        
        
        ">
      <a href="/snmp/">
          SNMP
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/spacewalk/" title="spacewalk client" class="dd-item 
        
        
        
        ">
      <a href="/spacewalk/">
          spacewalk client
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/freeipa/" title="freeipa client" class="dd-item 
        
        
        
        ">
      <a href="/freeipa/">
          freeipa client
          
      </a>
      
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/system_resources/" title="System Resources" class="dd-item 
        
        
        
        ">
      <a href="/system_resources/">
          System Resources
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            


 
  
    
    <li data-nav-id="/system_resources/hard_disk/" title="Increase Hard Disk" class="dd-item 
        
        
        
        ">
      <a href="/system_resources/hard_disk/">
          Increase Hard Disk
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/firewall/" title="Firewalld" class="dd-item 
        
        
        
        ">
      <a href="/firewall/">
          Firewalld
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/firewall/firewall_keepalive/" title="Firewalld &amp; Keepalived" class="dd-item ">
        <a href="/firewall/firewall_keepalive/">
        Firewalld &amp; Keepalived
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/firewall/firewall_richrule/" title="Rich Rule" class="dd-item ">
        <a href="/firewall/firewall_richrule/">
        Rich Rule
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            <a href='/'>Home</a> > Mail Cleaner
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Mail Cleaner
            </h1>
          

        




	<p>MailCleaner is a business anti spam gateway installed between your mail infrastructure and the Internet.
It offers professional protection against viruses and eliminates up to 99% of spam.</p>
<h4 id="requirements-and-planning">Requirements and planning</h4>
<p>Make sure that your hardware or Virtual Machine meets the minimum requirements:</p>
<pre><code>    ▪ 2 CPU, 4 GB RAM 
    ▪ 60 GB HDD
    ▪ 100 Mbps network card 
    ▪ 2 Mbps network connectivity
</code></pre>
<h4 id="virtual-machine-download--installation">Virtual Machine Download &amp; Installation:</h4>
<p>Download the latest MailCleaner Virtual Machine corresponding to your virtualization environment here:<strong><a href="https://www.mailcleaner.net/downloads/vm">https://www.mailcleaner.net/downloads/vm</a></strong> For installation instructions follow the README inside the ZIP file
In my case, I had downloaded the appliance of. ova format and imported it to the VMware vSphere. After the successful installation, login to the virtual machine with user ‘root’ and password &lsquo;MCPassw0rd&rsquo;. After login, there will be asked to complete the wizards. There in the wizard, you need to select the keyboard language, hostname, IP address. You can change the root password later.</p>
<p><img src="Picture1.png" alt="image"></p>
<h4 id="network-environment">Network environment:</h4>
<p>Please have on hand an IP address and a hostname to be dedicated to your MailCleaner. The hostname must be resolvable via DNS. Have a MX record of the IP in public DNS MailCleaner also needs Internet access on a number of ports. Make sure the firewall allows the all the ports required by Mailcleaner like SMTP, TCP, HTTPS, HTTP, LDAP, SSH etc.</p>
<h4 id="configuration-after-installation">Configuration after installation</h4>
<p>Once the installation of the Virtual Machine is finished, you can connect your favorite browser to the MailCleaner wizard configurator:<strong>https://yourhost:4242</strong> Where your host refers to either the hostname or the IP address. MailCleaner by default is configured for DHCP, so if you have DHCP, it will get an address on your network and you could check your equipment to see what address it got. If you do not have DHCP on your network MailCleaner could be accessible on 192.168.1.42. You can set your own static IP from terminal of while installing the virtual appliance. In the URL mentioned above, you will be redirected to the wizard. Complete the wizard, as per your requirements.</p>
<p><img src="Picture2.png" alt="image"></p>
<h4 id="registration">Registration</h4>
<p>Registration for enterprises edition:</p>
<p>If you wish to get automatic updates for your MailCleaner, you may want to register with Mail Cleaner’s update service. Once you get the settings back from our service (client id, reseller id/password, etc.), you must connect your favorite browser to the MailCleaner web administration interface:<strong>https://yourhost/admin/</strong> Where your host refers to either the hostname or the IP address you provided during the installation. The username is admin and the password is the one provided during the installation. Select “Configuration” menu, “Base system” sub-menu and “Registration” section You must fill all fields of this section with the information provided on your license certificate, by your reseller or directly by MailCleaner Sales Department.</p>
<p>What is your reseller ID?</p>
<p>The reseller ID as assigned by MailCleaner Sales Department.</p>
<p>What is your reseller password?</p>
<p>The password associated with the reseller ID as assigned by MailCleaner Sales Department. What is this client ID The client (or customer) ID as assigned by MailCleaner: 4-digit ID When finished, this step will register your MailCleaner installation with our update service? Available updates will then be fetched every 15 minutes. Anti-virus definitions are updated every hour by default.</p>
<h4 id="gui-configuration">Gui Configuration</h4>
<p>To activate the mailcleaner, it is required to properly configure the set up followed by mailcleaner GUI.</p>
<p><img src="Picture3.png" alt="image"></p>
<h5 id="go-to-configuration--base-system-and-configure-network-dns-localization-date-and-time-and-proxies-as-per-your-environment">Go to configuration =&gt; Base system and configure Network, DNS, Localization, Date and time and Proxies as per your environment.</h5>
<p><img src="Picture4.png" alt="image"></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h5 id="go-to-configuration--general-settings-and-configure-defaults-company-quarantines-periodic-tasks-logging-and-archiving">Go to configuration =&gt; General settings and configure defaults, Company, Quarantines, Periodic tasks, logging and archiving.</h5>
<p>After configuring Base system and General settings, it is more important to configure domains.
Adding domain is most critical and backbone of the mailcleaner.</p>
<p>To configure the Domain, follow the below steps.
<img src="1.png" alt="image"></p>
<h5 id="go-to-configuration--domain-there-you-will-see-the-domain-default-setting-and-new-domain">Go to Configuration =&gt; Domain, there you will see the Domain default setting and new domain.</h5>
<p>If you want the default configuration for all domains, configure in the default domain setting. Else, go to New Domain to add Domains. Add domain and submit.
To configure the individual domains, go to list of the domain and select it.
<img src="2.png" alt="image">
In the General fill the details of Aliases, postmaster address and support details. Submit the details and click next step.
<img src="3.png" alt="image"></p>
<p>In the Destination server, fill the IP address of the mail server in which mail will be sent from mailcleaner. Choose smtp port as 25 and use multiple server as load balancing. Submit the details and test the destination then go to next step
<img src="4.png" alt="image">
Next step is to configure Address verification. To configure address verification, go to Domain=&gt; Select Domain=&gt;Go to address verification.
You will need to configure the following details.</p>
<p><strong>Callout Connector:-</strong> This is the method which is used to authenticate the address. Callout connector uses LDAP, SMTP, NONE and LOCAL protocols.</p>
<p><strong>LDAP Server:</strong> If you are configuring with LDAP, you will need to define the LDAP server from which LDAP authentication is done.</p>
<p><strong>BASE DN:</strong> Base DN uses domain controller for the address verification.
If you are using Active directory to address verification, configure the Base DN as following
For domain: abc.com.np
Dc=abc, dc=com, dc=np</p>
<p><strong>Bind User and Bind Password:</strong> Use the user and password of the LDAP server. Submit the details and test configuration.</p>
<p>Go to Next Step and configure Preferences as per your requirement.</p>
<p>In the next step, will be redirected to Users Authentication. Any user defined in this step will authenticate users to the mailcleaner. To configure Users Authentication, follow the following steps.</p>
<p><img src="5.png" alt="image"></p>
<p><strong>Authentication Type:</strong> In the authentication type, we can see different authentication methods to get access. In my case, I have used ldap/Active Directory as an authentication method.</p>
<p><strong>Authentication Server:</strong> Define the Authentication Server in this section. In my case, I have defined the IP address of LDAP server as Authentication Server.</p>
<p><strong>BASE DN:</strong> Define the domain name from which LDAP users will be authenticated. If you have domain abc.com.np, please select the base DN as: dc=abc, dc=com, dc=np</p>
<p><strong>Bind User:</strong>  Select the user from LDAP server as bind user. In my case, I have used administrator as bind user.</p>
<p><strong>Bind Password:</strong> Use the password of the user from LDAP which is going to be used as bind user.</p>
<p><strong>User Attribute:</strong> If you are using ldap/active directory as authentication type, use ‘SamAccountName’ as user attribute.</p>
<p>Configure Use SSL, Protocol version, Username Modifier, Address lookup as in above snapshot and submit the details. After submission test any user from ldap/active directory and test authentication. If the configurations are correct, you will see the connection successful message.</p>
<p>Another step to be configured is Filtering. In this section, you can define the different filtering methods for any domain. Configure the mailcleaner as shown in snapshot. Enable greylisting and whitelisting.
If you want to select any domain to be not checked, mention it in the add an address.
<img src="6.png" alt="image">
Another step is to configure outgoing relay. In the configuration you will need to generate DKIM signing.
<img src="7.png" alt="image">
Make a configuration as shown in the above snapshot. You will need to enable BATV to generate DKIM signing. You will need to add this DKIM record to public dns.</p>
<p>Keep the configuration of archiving and templates as per default.</p>
<p>Configure SMTP, Anti-spam, Content protection, accesses and Services as per your requirement.</p>
<h4 id="5cluster-creation-and-implementation">5.	Cluster Creation and Implementation</h4>
<p>To filter very large volume of email and/or for security and redundancy reasons, MailCleaner has been developed, from the very beginning, to work in a cluster configuration. One server, defined as the master, holds the database configuration and hosts the administrator and user web interfaces. The other servers in the cluster are defined as slaves. First, install each server independently.</p>
<h5 id="master-configuration">Master Configuration:</h5>
<p>Use the script located in: <strong>/usr/mailcleaner/scripts/configuration/slaves.pl</strong></p>
<p>-The first time, you will have to set the real hostname of the master. The real hostname is the Fully Qualified Domain Name (FQDN) of the master server. This name must be resolvable by DNS. Alternatively, you can use the master server's IP address in place of its name.</p>
<p>▪Select option 1(fully qualified hostname or IP). By default, it is 127.0.0.1, which is to be changed in the case of a cluster.</p>
<p>▪Select option 4 to add a slave and enter the hostname or IP address and the password of the server.</p>
<p>▪Back in the main menu, hit q to apply changes.</p>
<h5 id="slave-configuration">Slave Configuration:</h5>
<p>Use the script located in: <strong>/usr/mailcleaner/scripts/configuration/slaves.pl</strong></p>
<p>The first time, you will have to set the real hostname of the slave. The real hostname is the Fully Qualified Domain Name (FQDN) of this slave. This name must be resolvable by DNS. Alternatively, you can use the server's IP address in place of its name</p>
<p>	Select option 1(fully qualified hostname or IP). By default, it is 127.0.0.1.</p>
<p>	Select option 5 to set this server as a slave. Enter the master's FQDN or IP address and password.</p>
<p>	Back in the main menu, hit q to apply changes.</p>
<p>You can now reach the admin interface of any server, but only the master will let you configure the system. The master is also the only server that allows users to access their quarantine.</p>
<p>You can now reach the admin interface of any host, but only the master will let you configure the system. It also is the only one that users can reach in order to access their quarantine.</p>
<p>In order to balance your incoming mail on the two (or more) nodes you can add a new MX record with the same priority pointing the second node. To test, go to user interface panel</p>
<p>After clustering, go to URL of master cluster there you will see the stack of master and slaves.</p>
<p>Verify the incoming and outgoing status of mails.
<img src="8.png" alt="image"></p>
<p>By : Aayush koirala</p>
<hr>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1584878192"></script>
    <script src="/js/perfect-scrollbar.min.js?1584878192"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1584878192"></script>
    <script src="/js/jquery.sticky.js?1584878192"></script>
    <script src="/js/featherlight.min.js?1584878192"></script>
    <script src="/js/highlight.pack.js?1584878192"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1584878192"></script>
    <script src="/js/learn.js?1584878192"></script>
    <script src="/js/hugo-learn.js?1584878192"></script>

    <link href="/mermaid/mermaid.css?1584878192" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1584878192"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>
