<!DOCTYPE html>
<html lang="en-us">
<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<title>Exchange - Tecnep</title>
<meta name="description" content="Share your notes.">
<meta name="generator" content="Hugo 0.68.0" />
<link href="https://linux.tecnep.comindex.xml" rel="alternate" type="application/rss+xml">
<link rel="canonical" href="https://linux.tecnep.com/exchnage/">
<link rel="stylesheet" href="https://linux.tecnep.com/css/theme.min.css">
<script src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<link rel="stylesheet" href="https://linux.tecnep.com/css/chroma.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery.easing@1.4.1/jquery.easing.min.js"></script>
<script src="https://linux.tecnep.com/js/bundle.js"></script><style>
:root {--custom-font-color: #edfaf1;--custom-background-color: #52555B;}
</style>
<meta property="og:title" content="Exchange" />
<meta property="og:description" content="Share your notes." />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://linux.tecnep.com/exchnage/" />
<meta property="og:image" content="https://linux.tecnep.com/images/og-image.png"/>
<meta property="og:site_name" content="tecnep.com" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://linux.tecnep.com/images/og-image.png"/>

<meta name="twitter:title" content="Exchange"/>
<meta name="twitter:description" content="Share your notes."/>
<meta itemprop="name" content="Exchange">
<meta itemprop="description" content="Share your notes."></head>
<body><div class="container"><header>
<h1>Tecnep</h1>

<p class="description">Share your notes.</p>

</header>
<div class="global-menu">
<nav>
<ul>
<li><a href="/">Home</a></li>
<li><a href="/"></a></li></ul>
</nav>
</div>
<div class="content-container">
<main><h1>Exchange</h1><p>Microsoft Exchange is Microsoft&rsquo;s mail server and calendaring. It runs on Windows Server operating systems and need Active directory domain service, DNS and Internet Information Service. The exchange 2013 is 64bit and comes in two editions. Standard edition which limits to five mounted database where as enterprise enable up to 500 mounted database. Microsoft release cumulative update of exchange server in every three months. Basically, it provides two roles, mail box server and client access server role.</p>
<p>Let us discuss its important terminologies and their uses.</p>
<h5 id="mailbox-enabled-user">Mailbox enabled user</h5>
<p>They are the users having account in Active Directory (AD) and also having mail box who can send and receive email. You can create mailbox user from Exchange control panel (ecp). Goto reception &gt; mailbox &gt; + &gt; user mailbox. Then give user email id, you can add a new user of provide mailbox to existing user from Active directory also.</p>
<p><img src="mailbox_user.png" alt="image"></p>
<h5 id="mail-enabled-user">Mail enabled user</h5>
<p>They are the users only having account in Active Directory (AD) and need external mail box to send and receive email. Such type of user are  created for vender, stake holder of the organization. Goto reception &gt; contacts &gt; + &gt; Mail user. Then give user external email id, you can add a new user of provide mailbox to existing user from Active directory also. But these user will not have storage for email (mailbox) here.</p>
<p><img src="mail_user.png" alt="image"></p>
<h5 id="rule-based-access-control">Rule Based access control</h5>
<p>Rule Based access control (RBAC) are the rules that defines who can access what. Assigning a user to view audit log or generating reports, enabling admin user to create and modify mailbox are the example of rule based access control.</p>
<p><img src="rbac.png" alt="image"></p>
<p>Visiting to Permission tab, you can create access control rules. These rules can be applied for admin or users. Select of add rules and configure it. You need to assign roles and members for specific rules set.</p>
<h5 id="room-mail-box">Room Mail Box</h5>
<p>A room mailbox is a resource mailbox that&rsquo;s assigned to a physical location, such as a conference room, an auditorium, or a training room. With room mailboxes, users can easily reserve these rooms by including room mailboxes in their meeting requests.</p>
<p><img src="room_mailbox.png" alt="image"></p>
<p>Goto reception &gt; resources &gt; + &gt; Room mailbox. Give Room name, organizational unit who can book and use the room. Also provide location, phone and capacity of the room.</p>
<h5 id="journaling">Journaling</h5>
<p>A method that perform backup and logging of all copies of email sent to or from specific users. Even if a email is deleted, journaling system has access to the original content.</p>
<p><img src="journal_rules.png" alt="image"></p>
<p>To set journal rule, you need to go to compliance management and choose journal tab. Put email address in the box <code>send journal report to</code> which you want to receive email. Give a name and specify either to choose a specific group or all the messages. You need premium license to journal all the emails.</p>
<h5 id="accepted-domain">Accepted Domain</h5>
<p>Accepted domains is an SMTP namespace that the Exchange organization can send and receive email for.</p>
<p><img src="accepted_domain.png" alt="image"></p>
<p>You can see in above description of what authoritative, internal and external relay is for.</p>
<h5 id="connectors">Connectors</h5>
<p>Connector is like next hub for email to send from exchange. It is of two types <code>send connector</code> and <code>receive connector</code>. When you first install exchange, you need to configure send connector to send email to the public domain.</p>
<p>To create send connector, Go to mail flow &gt; send connector &gt; + . Give Suitable name and choose <code>Internet</code>. Click on Next.
<img src="send_connector.png" alt="image"></p>
<p>Choose <code>Route mail through smart host</code> and click on Next.</p>
<p><img src="route_smart_host.png" alt="image"></p>
<p>Enter <code>*</code> and click on Save.</p>
<p><img src="smart_host.PNG" alt="image"></p>
<h5 id="global-catalog-server">Global Catalog Server</h5>
<p>Global catalog server are important component of Active Directory service. It provides other services like Exchange to search for and locate objects from any domain in the forest. In your domain of servers, first domain controller will be auto assigned as Global Catalog server. At the time of authentication, identify of domain  is provided by GC server. Exchange depends on Catalog server for email lookup and other email data. So, there must be one GC server for the operation of Exchange.</p>
<h5 id="exchange-active-sync">Exchange Active Sync</h5>
<p>Exchange ActiveSync is an Exchange synchronization protocol based on HTTP and XML, lets mobile phones access an organization&rsquo;s information on a server that&rsquo;s running Microsoft Exchange. Exchange ActiveSync lets mobile phone users access their email, calendar, contacts, and tasks, and lets them continue to access this information when they&rsquo;re working offline.</p>
<h5 id="important-command">Important Command</h5>
<p>Use Exchange Management Shell to execute following commands.</p>
<p><strong>Get Exchange information</strong></p>
<pre><code>Get-ExchangeServer | Format-List
</code></pre><p><strong>Get first 30 mail box which are occupying maximum storage</strong></p>
<pre><code>Get-Mailbox -ResultSize Unlimited | Get-MailboxStatistics | Sort-Object TotalItemSize -Descending | Select-Object DisplayName,TotalItemSize -First 30
</code></pre><p><strong>Get internal and external URL</strong></p>
<pre><code>Get-ECPvirtualDirectory | Format-List Name, InternalURL, ExternalURL
</code></pre><p><strong>Get server componets states</strong></p>
<pre><code>Get-ServerComponentState -Identity  MX-04
</code></pre><p><strong>Restart ImapProxy service / Set the ImapProxy state to active</strong></p>
<pre><code>Set-ServerComponentState -Identity MX-04 -Component ImapProxy -Requester HealthAPI -State Active
</code></pre><p><strong>Set the PopProxy state to active / Restart ImapProxy service</strong></p>
<pre><code>Set-ServerComponentState -Identity MX-04 -Component PopProxy -Requester HealthAPI -State Active
</code></pre><p><strong>Backup deleted email. By default deleted mailbox is stored for 14 days.</strong></p>
<p>Use the Get-MailboxStatistics cmdlet to display the values of the DisplayName, MailboxGuid, and LegacyDN properties for the deleted mailbox that you want to restore.</p>
<pre><code>$dbs = Get-MailboxDatabase
$dbs | foreach {Get-MailboxStatistics -Database $_.DistinguishedName} | where {$_.DisconnectReason -eq &quot;Disabled&quot;} | Format-Table DisplayName,MailboxGuid,Database,DisconnectDate
</code></pre><p>Now use following command and input SourceStoreMailbox and SourceDatabase from the result you just get.</p>
<pre><code>New-MailboxRestoreRequest -SourceStoreMailbox af5c3f96-d3df-4271-88c4-4818d7ca0bef -SourceDatabase 0702033906 -TargetMailbox &quot;Firstname lastname&quot; -AllowLegacyDNMismatch
</code></pre><hr>
<p>Pratik Gautam
<a href="mailto:pratikgautm@gmail.com">pratikgautm@gmail.com</a></p>
<div class="edit-meta">
<br>
<a href="https://github.com/pratikgautm/tecnep" class="edit-page"><i class="fas fa-pen-square"></i> Edit on GitHub</a>
</div><nav class="pagination"><a class="nav nav-prev" href="https://linux.tecnep.com/php_nginx_mysql/" title="Php Nginx Mysql"><i class="fas fa-arrow-left" aria-hidden="true"></i> Prev - Php Nginx Mysql</a>
<a class="nav nav-next" href="https://linux.tecnep.com/samba/" title="Samba">Next - Samba <i class="fas fa-arrow-right" aria-hidden="true"></i></a>
</nav><footer>
<p class="powered"> Developers <a href="https://tecnep.com"> tecnep.com </a> </p>
</footer>
</main><div class="sidebar">

<nav class="slide-menu">
<ul>
<li class=""><a href="https://linux.tecnep.com">Home</a></li>

<li class=""><a href="https://linux.tecnep.com/hardening/">System Hardening</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/chrony/">NTP</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/redis/">Redis</a>
  
</li>

<li class=" has-sub-menu"><a href="https://linux.tecnep.com/mailcleaner/">Mailcleaner<span class="mark closed">+</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://linux.tecnep.com/mailcleaner/mailcleaner_config/">MailCleaner configurations</a></li>
</ul>
  
</li>

<li class=""><a href="https://linux.tecnep.com/kaspersky/">Kaspersky for linux</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/snmp/">SNMP</a>
  
</li>

<li class=" has-sub-menu"><a href="https://linux.tecnep.com/firewall/">Firewall<span class="mark closed">+</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://linux.tecnep.com/firewall/firewall_keepalive/">Firewalld and keepalived</a></li>
<li class=""><a href="https://linux.tecnep.com/firewall/rich_rule/">Rich rule</a></li>
</ul>
  
</li>

<li class=" has-sub-menu"><a href="https://linux.tecnep.com/zimbra/">Zimbra<span class="mark closed">+</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://linux.tecnep.com/zimbra/zimbra_tips_tricks/">Zimbra Tips &amp; Tricks</a></li>
<li class=""><a href="https://linux.tecnep.com/zimbra/backup/">Backup</a></li>
</ul>
  
</li>

<li class=""><a href="https://linux.tecnep.com/glassfish/">Glassfish</a>
  
</li>

<li class=" has-sub-menu"><a href="https://linux.tecnep.com/storage/">Storage<span class="mark closed">+</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://linux.tecnep.com/storage/lvm/">LVM</a></li>
<li class=""><a href="https://linux.tecnep.com/storage/raid/">RAID</a></li>
<li class=""><a href="https://linux.tecnep.com/storage/drbd/">DRBD</a></li>
<li class=""><a href="https://linux.tecnep.com/storage/glusterfs/">Glusterfs</a></li>
<li class=""><a href="https://linux.tecnep.com/storage/minio/">Minio</a></li>
<li class=""><a href="https://linux.tecnep.com/storage/ceph/">Ceph</a></li>
</ul>
  
</li>

<li class=""><a href="https://linux.tecnep.com/tomcat/">Tomcat</a>
  
</li>

<li class=" has-sub-menu"><a href="https://linux.tecnep.com/dns/">DNS<span class="mark closed">+</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://linux.tecnep.com/dns/spf/">SPF</a></li>
<li class=""><a href="https://linux.tecnep.com/dns/dkim/">DKIM</a></li>
<li class=""><a href="https://linux.tecnep.com/dns/dmarc/">DMARC</a></li>
<li class=""><a href="https://linux.tecnep.com/dns/unbound/">Unbound</a></li>
</ul>
  
</li>

<li class=""><a href="https://linux.tecnep.com/keepalive/">Keepalive</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/ssl/">SSL</a>
  
</li>

<li class=" has-sub-menu"><a href="https://linux.tecnep.com/haproxy/">Haproxy<span class="mark closed">+</span></a>
  
<ul class="sub-menu">
<li class=""><a href="https://linux.tecnep.com/haproxy/installation/">Installation</a></li>
<li class=""><a href="https://linux.tecnep.com/haproxy/configuration/">Configuration</a></li>
</ul>
  
</li>

<li class=""><a href="https://linux.tecnep.com/php_nginx_mysql/">Php Nginx Mysql</a>
  
</li>

<li class="parent active"><a href="https://linux.tecnep.com/exchnage/">Exchange</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/samba/">Samba</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/vmware/">Vmware</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/mysql/">Mysql/Mariadb</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/ansible/">Ansible</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/docker/">Docker</a>
  
</li>

<li class=""><a href="https://linux.tecnep.com/wazuh/">Wazuh</a>
  
</li>
</ul>
</nav>



<div class="sidebar-footer"></div>
</div>
</div><a href="#" id="backtothetop-fixed" class="backtothetop"
 data-backtothetop-duration="600"
 data-backtothetop-easing="easeOutQuart"
 data-backtothetop-fixed-fadeIn="1000"
 data-backtothetop-fixed-fadeOut="1000"
 data-backtothetop-fixed-bottom="10"
 data-backtothetop-fixed-right="20">
<span class="fa-layers fa-fw">
<i class="fas fa-circle"></i>
<i class="fas fa-arrow-circle-up"></i>
</span></a>
</div>
</body>
</html>
